namespace proyectoRegistroVehiculoVersion2;

class Program
{
    static void Main(string[] args)
    {
        // Vehiculo[] vehiculos = new Vehiculo[20];

        // // --- 1. CAMIONETA (Existente)
        // vehiculos[0] = new Vehiculo(
        //     marca: "TOYOTA",
        //     modelo: 2024,
        //     fechaRegistro: new DateTime(2024, 10, 20),
        //     tipo: "CAMIONETA",
        //     placa: "ABC-123",
        //     cilindrada: 2500
        // );

        // // --- 2. MOTOCICLETA (Existente)
        // vehiculos[1] = new Vehiculo(
        //     marca: "HONDA",
        //     modelo: 2023,
        //     fechaRegistro: new DateTime(2023, 05, 15),
        //     tipo: "MOTOCICLETA",
        //     placa: "MOTO-456",
        //     cilindrada: 150
        // );

        // // --- 3. VAGONETA (Existente)
        // vehiculos[2] = new Vehiculo(
        //     marca: "NISSAN",
        //     modelo: 2018,
        //     fechaRegistro: new DateTime(2018, 01, 10),
        //     tipo: "VAGONETA",
        //     placa: "XYZ-789",
        //     cilindrada: 1600
        // );

        // // --- 4. CAMIONETA (Existente)
        // vehiculos[3] = new Vehiculo(
        //     marca: "FORD",
        //     modelo: 2022,
        //     fechaRegistro: new DateTime(2024, 02, 29),
        //     tipo: "CAMIONETA",
        //     placa: "DEF-001",
        //     cilindrada: 3000
        // );

        // // --- 5. MOTOCICLETA (Existente)
        // vehiculos[4] = new Vehiculo(
        //     marca: "SUZUKI",
        //     modelo: 2021,
        //     fechaRegistro: new DateTime(2021, 07, 07),
        //     tipo: "MOTOCICLETA",
        //     placa: "MOTO-999",
        //     cilindrada: 200
        // );

        // // --- 6. VAGONETA (Existente)
        // vehiculos[5] = new Vehiculo(
        //     marca: "CHEVROLET",
        //     modelo: 2015,
        //     fechaRegistro: new DateTime(2015, 03, 01),
        //     tipo: "VAGONETA",
        //     placa: "GTR-007",
        //     cilindrada: 1400
        // );

        // // --- 7. CAMIONETA (Existente)
        // vehiculos[6] = new Vehiculo(
        //     marca: "MITSUBISHI",
        //     modelo: 2020,
        //     fechaRegistro: new DateTime(2020, 11, 25),
        //     tipo: "CAMIONETA",
        //     placa: "LND-111",
        //     cilindrada: 2800
        // );

        // // --- 8. MOTOCICLETA (Existente)
        // vehiculos[7] = new Vehiculo(
        //     marca: "YAMAHA",
        //     modelo: 2024,
        //     fechaRegistro: new DateTime(2024, 08, 10),
        //     tipo: "MOTOCICLETA",
        //     placa: "YMH-234",
        //     cilindrada: 350
        // );

        // // --- 9. VAGONETA (Existente)
        // vehiculos[8] = new Vehiculo(
        //     marca: "HYUNDAI",
        //     modelo: 2019,
        //     fechaRegistro: new DateTime(2019, 06, 17),
        //     tipo: "VAGONETA",
        //     placa: "HDA-555",
        //     cilindrada: 1800
        // );

        // // --- 10. CAMIONETA (Existente)
        // vehiculos[9] = new Vehiculo(
        //     marca: "DODGE",
        //     modelo: 2023,
        //     fechaRegistro: new DateTime(2023, 09, 01),
        //     tipo: "CAMIONETA",
        //     placa: "DGE-777",
        //     cilindrada: 4000
        // );

        // // --- 11. MOTOCICLETA (Existente)
        // vehiculos[10] = new Vehiculo(
        //     marca: "KAWASAKI",
        //     modelo: 2020,
        //     fechaRegistro: new DateTime(2020, 04, 04),
        //     tipo: "MOTOCICLETA",
        //     placa: "KWK-888",
        //     cilindrada: 450
        // );

        // // --- 12. VAGONETA (Existente)
        // vehiculos[11] = new Vehiculo(
        //     marca: "KIA",
        //     modelo: 2017,
        //     fechaRegistro: new DateTime(2017, 12, 12),
        //     tipo: "VAGONETA",
        //     placa: "KIA-321",
        //     cilindrada: 1600
        // );

        // // --- 13. CAMIONETA (Existente)
        // vehiculos[12] = new Vehiculo(
        //     marca: "NISSAN",
        //     modelo: 2021,
        //     fechaRegistro: new DateTime(2021, 01, 01),
        //     tipo: "CAMIONETA",
        //     placa: "NSX-000",
        //     cilindrada: 2000
        // );

        // // --- 14. VAGONETA (Existente)
        // vehiculos[13] = new Vehiculo(
        //     marca: "RENAULT",
        //     modelo: 2024,
        //     fechaRegistro: new DateTime(2024, 05, 05),
        //     tipo: "VAGONETA",
        //     placa: "RNL-444",
        //     cilindrada: 1200
        // );

        // // --- 15. MOTOCICLETA (Existente)
        // vehiculos[14] = new Vehiculo(
        //     marca: "BMW",
        //     modelo: 2023,
        //     fechaRegistro: new DateTime(2023, 11, 11),
        //     tipo: "MOTOCICLETA",
        //     placa: "BMW-100",
        //     cilindrada: 900
        // );

        // // --- 16. AUTOMÓVIL (Nuevo Tipo)
        // vehiculos[15] = new Vehiculo(
        //     marca: "MERCEDES",
        //     modelo: 2024,
        //     fechaRegistro: new DateTime(2024, 11, 15),
        //     tipo: "AUTOMÓVIL",
        //     placa: "LUJO-1A",
        //     cilindrada: 2000
        // );

        // // --- 17. CAMIONETA (Adicional)
        // vehiculos[16] = new Vehiculo(
        //     marca: "GMC",
        //     modelo: 2020,
        //     fechaRegistro: new DateTime(2020, 08, 01),
        //     tipo: "CAMIONETA",
        //     placa: "HEAVY-2B",
        //     cilindrada: 5000
        // );

        // // --- 18. AUTOMÓVIL (Adicional)
        // vehiculos[17] = new Vehiculo(
        //     marca: "AUDI",
        //     modelo: 2022,
        //     fechaRegistro: new DateTime(2022, 03, 03),
        //     tipo: "AUTOMÓVIL",
        //     placa: "FAST-3C",
        //     cilindrada: 1800
        // );

        // // --- 19. MOTOCICLETA (Adicional)
        // vehiculos[18] = new Vehiculo(
        //     marca: "HARLEY",
        //     modelo: 2019,
        //     fechaRegistro: new DateTime(2019, 09, 09),
        //     tipo: "MOTOCICLETA",
        //     placa: "CRUZ-4D",
        //     cilindrada: 1200
        // );

        // // --- 20. VAGONETA (Adicional)
        // vehiculos[19] = new Vehiculo(
        //     marca: "PEUGEOT",
        //     modelo: 2021,
        //     fechaRegistro: new DateTime(2021, 10, 10),
        //     tipo: "VAGONETA",
        //     placa: "EURO-5E",
        //     cilindrada: 1500
        // );


        int numVehiculos = 0, opcionElegida = 0;
        Vehiculo[] vehiculos = null;
        Vehiculo[] vehiculosModeloDecendente = null;
        Vehiculo[] vehiculosPlacaDecendente = null;
        bool ordenadoPorModelo = false, ordenadoPorPlaca = false;
        do
        {
            opcionElegida = menuPrincipal();

            switch (opcionElegida)
            {
                case 1:
                    Console.ForegroundColor = ConsoleColor.Yellow;
                    Console.WriteLine("\n*** ESTABLECER NUMERO DE VEHICULOS ****");
                    Console.ResetColor();
                    setNumeroDeVehiculos(ref vehiculos, ref numVehiculos);
                    break;
                case 2:
                    Console.ForegroundColor = ConsoleColor.Yellow;
                    Console.WriteLine("\n*** INTRODUCIR DATOS DE LOS VEHICULOS ****\n");
                    Console.ResetColor();
                    leerDatosDeVehiculos(vehiculos);
                    CopiarAccesoVehiculos(vehiculos, ref vehiculosModeloDecendente, ref vehiculosPlacaDecendente);
                    break;
                case 3:
                    Console.ForegroundColor = ConsoleColor.Yellow;
                    Console.WriteLine("\n*** GENERAR INDICES PARA LOS ACCESOS A VEHICULOS ****\n");
                    OrdenadoPorModelo(vehiculosModeloDecendente, ref ordenadoPorModelo);
                    OrdenadoPorPlaca(vehiculosPlacaDecendente, ref ordenadoPorPlaca);
                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.WriteLine($"\n{"",12}Indices creados¡!");
                    Console.ResetColor();
                    Console.WriteLine("\n\nPresione cualquier tecla para continuar...");
                    Console.ReadKey();
                    break;
                case 4:
                    Console.ForegroundColor = ConsoleColor.Yellow;
                    Console.WriteLine($"\n{"",30}*** LISTA GENERAL DE VEHICULOS ****\n");
                    Console.ResetColor();
                    mostrarListaGeneralDeVehiculos(vehiculos);
                    Console.WriteLine("\n\nPresione cualquier tecla para continuar...");
                    Console.ReadKey();
                    break;
                case 5:
                    Console.ForegroundColor = ConsoleColor.Yellow;
                    Console.WriteLine($"\n{"",26}*** LISTA DE VEHICULOS AGRUPADOS POR TIPO ****\n");
                    Console.ResetColor();
                    mostrarListaDeVehiculosPorTipo(vehiculos);
                    Console.WriteLine("\n\nPresione cualquier tecla para continuar...");
                    Console.ReadKey();
                    break;
                case 6:
                    Console.ForegroundColor = ConsoleColor.Yellow;
                    Console.WriteLine($"\n{"",26}*** LISTA DE VEHICULOS ORDENADOS POR MODELO ****\n");
                    Console.ResetColor();
                    mostrarListaOrdenadaPorModelo(vehiculosModeloDecendente);
                    Console.WriteLine("\n\nPresione cualquier tecla para continuar...");
                    Console.ReadKey();
                    break;
                case 7:
                    Console.ForegroundColor = ConsoleColor.Yellow;
                    Console.WriteLine($"\n{"",26}*** LISTA DE VEHICULOS ORDENADOS POR PLACA ****\n");
                    Console.ResetColor();
                    mostrarListaOrdenadaPorPlaca(vehiculosPlacaDecendente);
                    Console.WriteLine("\n\nPresione cualquier tecla para continuar...");
                    Console.ReadKey();
                    break;
                case 8:
                    Console.ForegroundColor = ConsoleColor.Yellow;
                    Console.WriteLine($"\n{"",10}*** FINALIZAR PROGRAMA ****\n");
                    Console.ResetColor();
                    break;
            }

        } while (opcionElegida >= 1 && opcionElegida <= 7);
    }


    private static int menuPrincipal()
    {
        int opcion;

        do
        {
            Console.ForegroundColor = ConsoleColor.Yellow;
            Console.WriteLine($"\n{"",12}*** MENÚ PRINCIPAL ***");
            Console.ResetColor();
            Console.WriteLine("ESTABLECER NÚMERO DE VEHÍCULOS................... 1");
            Console.WriteLine("INTRODUCIR DATOS DE LOS VEHÍCULOS................ 2");
            Console.WriteLine("GENERAR ÍNDICES PARA LOS ACCESOS A VEHÍCULOS..... 3");
            Console.WriteLine("LISTA GENERAL DE VEHÍCULOS....................... 4");
            Console.WriteLine("LISTA DE VEHÍCULOS AGRUPADOS POR TIPO............ 5");
            Console.WriteLine("LISTA DE VEHÍCULOS ORDENADOS POR MODELO.......... 6");
            Console.WriteLine("LISTA DE VEHÍCULOS ORDENADOS POR PLACA........... 7");
            Console.WriteLine("---------------------------------------------------");
            Console.WriteLine("FINALIZAR PROGRAMA............................... 8");
            Console.WriteLine("--------------- ESCRIBA UNA OPCIÓN ----------------");
            Console.Write("Opción: ");
            opcion = int.Parse(Console.ReadLine());
            if (opcion < 1 || opcion > 8)
            {
                Console.ForegroundColor = ConsoleColor.Red;
                Console.WriteLine(">>>>>>>>>>>>> Opcion invalida");
                Console.ResetColor();
            }
        } while (opcion < 1 || opcion > 8);
        return opcion;
    }

    // --- FUNCIONES INSERCION DE DATOS ---
    private static void setNumeroDeVehiculos(ref Vehiculo[] vehiculos, ref int numVehiculos)
    {
        Console.Write("Cantidad: ");
        numVehiculos = int.Parse(Console.ReadLine());
        vehiculos = new Vehiculo[numVehiculos];
    }
    private static void leerDatosDeVehiculos(Vehiculo[] vehiculos)
    {
        bool correcto;
        int cilindrada, modelo, tipoEleccion;
        string marca, tipo, placa;
        DateTime fechaRegistro;
        for (int i = 0; i < vehiculos.Length; i++)
        {
            Console.WriteLine($"\nIngrese los datos del vehiculo N° {i + 1}");

            Console.Write("\nMarca: ");
            marca = Console.ReadLine().ToUpper();
            do
            {
                Console.Write("Modelo: ");
                correcto = int.TryParse(Console.ReadLine(), out modelo);
                if (!correcto)
                {
                    Console.WriteLine("Ingresa un modelo valido");
                }
            } while (!correcto);
            do
            {
                Console.Write("Fecha de Registro (Dia/Mes/Año): ");
                correcto = DateTime.TryParse(Console.ReadLine(), out fechaRegistro);
                if (!correcto)
                {
                    Console.WriteLine("Ingresa una fecha valida");
                }
            } while (!correcto);
            do
            {
                Console.Write("Tipo (vagoneta(1), motocicleta(2), automóvil(3), camioneta(4)): ");
                correcto = int.TryParse(Console.ReadLine(), out tipoEleccion);
                if (correcto && tipoEleccion > 0 && tipoEleccion < 5)
                {
                    switch (tipoEleccion)
                    {
                        case 1:
                            tipo = "VAGONETA";
                            correcto = true;
                            break;
                        case 2:
                            tipo = "MOTOCICLETA";
                            correcto = true;
                            break;
                        case 3:
                            tipo = "AUTOMÓVIL";
                            correcto = true;
                            break;
                        case 4:
                            tipo = "CAMIONETA";
                            correcto = true;
                            break;
                        default:
                            correcto = false;
                            tipo = "";
                            break;
                    }
                }
                else
                {
                    Console.WriteLine("Ingresa un tipo valido");
                    correcto = false;
                    tipo = "";
                }
            } while (!correcto);
            Console.Write("Placa: ");
            placa = Console.ReadLine().ToUpper();
            do
            {
                Console.Write("Cilindrada: ");
                correcto = int.TryParse(Console.ReadLine(), out cilindrada);
                if (!correcto)
                {
                    Console.WriteLine("Ingresa una cilindrada numerica valida");
                }
            } while (!correcto);

            vehiculos[i] = new Vehiculo(marca, modelo, fechaRegistro, tipo, placa, cilindrada);
        }
    }

    // --- FUNCIONES COPIAR ACCESO ---
    private static void CopiarAccesoVehiculos(Vehiculo[] vehiculos, ref Vehiculo[] vehiculosModeloDecendente, ref Vehiculo[] vehiculosPlacaDecendente)
    {
        vehiculosModeloDecendente = new Vehiculo[vehiculos.Length];
        vehiculosPlacaDecendente = new Vehiculo[vehiculos.Length];
        for (int i = 0; i < vehiculos.Length; i++)
        {
            vehiculosModeloDecendente[i] = vehiculos[i];
            vehiculosPlacaDecendente[i] = vehiculos[i];
        }
    }

    //-- FUNCIONES ORDENAMIENTO ---
    private static void OrdenadoPorModelo(Vehiculo[] vehiculosModeloDecendente, ref bool ordenadoPorModelo)
    {
        if (!ordenadoPorModelo)
        {
            int limite = vehiculosModeloDecendente.Length - 1;
            bool hayIntercambio;
            do
            {
                hayIntercambio = false;
                for (int i = 0; i < limite; i++)
                {

                    if (vehiculosModeloDecendente[i].Modelo < vehiculosModeloDecendente[i + 1].Modelo)
                    {
                        intercambiar(ref vehiculosModeloDecendente[i], ref vehiculosModeloDecendente[i + 1]);
                        hayIntercambio = true;
                    }
                }
                limite--;
            } while (hayIntercambio);
            ordenadoPorModelo = true;
        }
    }
    private static void OrdenadoPorPlaca(Vehiculo[] vehiculosPlacaDecendente, ref bool ordenadoPorPlaca)
    {
        if (!ordenadoPorPlaca)
        {
            int limite = vehiculosPlacaDecendente.Length - 1;
            int resultadoDeComparacion;
            bool hayIntercambio;
            do
            {
                hayIntercambio = false;
                for (int i = 0; i < limite; i++)
                {
                    resultadoDeComparacion = string.Compare(vehiculosPlacaDecendente[i].Placa, vehiculosPlacaDecendente[i + 1].Placa);
                    if (resultadoDeComparacion < 0)
                    {
                        intercambiar(ref vehiculosPlacaDecendente[i], ref vehiculosPlacaDecendente[i + 1]);
                        hayIntercambio = true;
                    }
                }
                limite--;
            } while (hayIntercambio);
            ordenadoPorPlaca = true;
        }
    }
    private static void intercambiar(ref Vehiculo vehiculo1, ref Vehiculo vehiculo2)
    {
        Vehiculo aux = vehiculo1;
        vehiculo1 = vehiculo2;
        vehiculo2 = aux;
    }

    //-- FUNCIONES MOSTRAR LISTAS ---
    private static void mostrarListaGeneralDeVehiculos(Vehiculo[] vehiculos)
    {
        int k = 1;
        Console.ForegroundColor = ConsoleColor.Yellow;
        Console.WriteLine($"\n\n{"",30}---- LISTA GENERAL DE VEHICULOS ----\n");
        Console.WriteLine($"{"N°"}\t{"marca",10}\t{"modelo",6}\t{"fecha de registro",20}\t{"tipo",12}\t{"placa",10}\t{"cilindrada",12}\n");
        Console.ResetColor();
        foreach (var vehiculo in vehiculos)
        {
            string fechaFormateada = vehiculo.FechaRegistro.ToString("dd MMM yyyy");
            Console.WriteLine($"{k}\t{vehiculo.Marca,10}\t{vehiculo.Modelo,6}\t{fechaFormateada,20}\t{vehiculo.Tipo,12}\t{vehiculo.Placa,10}\t{vehiculo.Cilindrada,12}");
            k++;
        }
    }
    private static void mostrarListaDeVehiculosPorTipo(Vehiculo[] vehiculos)
    {
        int tipoEleccion = 0;
        string? tipo = string.Empty;
        for (int i = 0; i < 4; i++)
        {
            tipoEleccion++;
            int k = 1;
            switch (tipoEleccion)
            {
                case 1:
                    tipo = "CAMIONETA";
                    break;
                case 2:
                    tipo = "MOTOCICLETA";
                    break;
                case 3:
                    tipo = "AUTOMÓVIL";
                    break;
                case 4:
                    tipo = "VAGONETA";
                    break;
            }

            Console.ForegroundColor = ConsoleColor.Yellow;
            Console.WriteLine($"\n\n{"",30}--- LISTA DE VEHÍCULOS TIPO {tipo}---\n");
            Console.WriteLine($"{"N°"}\t{"marca",10}\t{"modelo",6}\t{"fecha de registro",20}\t{"tipo",12}\t{"placa",10}\t{"cilindrada",12}\n");
            Console.ResetColor();

            foreach (var vehiculo in vehiculos)
            {
                if (vehiculo.Tipo == tipo)
                {
                    string fechaFormato = vehiculo.FechaRegistro.ToString("dd-MM-yyyy");
                    Console.WriteLine($"{k}\t{vehiculo.Marca,10}\t{vehiculo.Modelo,6}\t{fechaFormato,20}\t{vehiculo.Tipo,12}\t{vehiculo.Placa,10}\t{vehiculo.Cilindrada,12}");
                    k++;
                }
            }
        }
    }
    private static void mostrarListaOrdenadaPorModelo(Vehiculo[] vehiculos)
    {
        int k = 1;
        Console.ForegroundColor = ConsoleColor.Yellow;
        Console.WriteLine($"\n\n{"",30}---- LISTA ORDENADA POR MODELO ----\n");
        Console.WriteLine($"{"N°"}\t{"marca",10}\t{"modelo",6}\t{"fecha de registro",20}\t{"tipo",12}\t{"placa",10}\t{"cilindrada",12}\n");
        Console.ResetColor();
        foreach (var vehiculo in vehiculos)
        {
            string fechaFormateada = vehiculo.FechaRegistro.ToString("dd MMM yyyy");
            Console.WriteLine($"{k}\t{vehiculo.Marca,10}\t{vehiculo.Modelo,6}\t{fechaFormateada,20}\t{vehiculo.Tipo,12}\t{vehiculo.Placa,10}\t{vehiculo.Cilindrada,12}");
            k++;
        }
    }
    private static void mostrarListaOrdenadaPorPlaca(Vehiculo[] vehiculos)
    {
        int k = 1;
        Console.ForegroundColor = ConsoleColor.Yellow;
        Console.WriteLine($"\n\n{"",30}---- LISTA ORDENADA POR PLACA ----\n");
        Console.WriteLine($"{"N°"}\t{"marca",10}\t{"modelo",6}\t{"fecha de registro",20}\t{"tipo",12}\t{"placa",10}\t{"cilindrada",12}\n");
        Console.ResetColor();
        foreach (var vehiculo in vehiculos)
        {
            string fechaFormateada = vehiculo.FechaRegistro.ToString("dd MMM yyyy");
            Console.WriteLine($"{k}\t{vehiculo.Marca,10}\t{vehiculo.Modelo,6}\t{fechaFormateada,20}\t{vehiculo.Tipo,12}\t{vehiculo.Placa,10}\t{vehiculo.Cilindrada,12}");
            k++;
        }
    }







}
